<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>

  <meta charset="UTF-8"> <title>Test Title</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/main.css">

  <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase.js"></script>
  <script type="text/javascript" src = "./js/deletedata.js"></script>
  <script type="text/javascript" src = "./js/adddata.js"></script>

</head>



<body>
  DB 입력 테스트 </br>
  firebase realtime DB
  <p id="demo">A Paragraph.</p>
  행사명: <input type="text" id="name" size="20"> </br>
  위치: <input type="text" id="where" size="20"> </br>
  시작날짜(xxxx-xx-xx 형식) <input type="text" id="stdate" size="20"> </br>
  종료날짜(xxxx-xx-xx 형식) <input type="text" id="eddate" size="20"> </br>
  주최자: <input type="text" id="who" size="20"> </br>

  <pre id="object"></pre>
  
  <script>init_DB();</script>
  
  <button type="button"onclick="push();">데이터 쓰기</button>
  <button type="button" id = 'aa' onclick="del(this.id)">데이터 삭제</button>
  <div id="filesubmit">
    <input type="file" class="file-select" id="file" accept="image/*"/>
    <button class="file-submit" id = 'submit'">사진 등록</button>
  </div>
  
  <script>var btn = document.getElementById('aa')
    btn.setAttribute("id", "-NCipCb63aYcRPpn3hfb")</script>
  <img src=path id = 'aa'>
  <script>document.addEventListener('DOMContentLoaded', function () {
    const storageRef = firebase.storage().ref();
    let selectedFile;
  
    // File 선택
    document.getElementById('file').addEventListener('change', e => {
        selectedFile = e.target.files[0];
    });
  
    // File 업로드
    document.getElementById('submit').addEventListener('click', () => {
        storageRef
                .child(`images/${selectedFile.name}`)
                .put(selectedFile)
                .on('state_changed', snapshot => {
                                            console.log(snapshot)
                                        }, error => {
                                            console.log(error);
                                        }, () => {
                                            console.log('성공');
                                        }
                );
    });
  


  
    const storage = firebase.storage();

storage.ref(`images/${selectedFile.name}`).getDownloadURL()
  .then((url) => {
     alert(url)
     document.getElementById('aa').setAttribute("src", url)
  })
});
  </script>

</body>







</html>